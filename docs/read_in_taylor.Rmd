---
title: "read_in_taylor"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
library(janitor)
library(lubridate)
library(skimr)
library(patchwork)
```

# Read in the Data from the Taylor server from EDS214 -> ShaleCoRyJoe
```{r}
Q1 = read_csv(here("/courses","EDS214", "ShaleCoRyJoe","data", "QuebradaCuenca1-Bisley.csv"), na = "-9999")

Q2 = read_csv(here("/courses","EDS214", "ShaleCoRyJoe","data", "QuebradaCuenca2-Bisley.csv"), na = "-9999")

Q3 = read_csv(here("/courses","EDS214", "ShaleCoRyJoe","data", "QuebradaCuenca3-Bisley.csv"), na = "-9999")

PRM = read_csv(here("/courses","EDS214", "ShaleCoRyJoe","data", "RioMameyesPuenteRoto.csv"), na = "-9999")
   
```

# Clean the data from the raw files
Note, the units for all the chemistry data is the same per the metadata. The ".1" added to the original data frame names is to designate that they are different from the original read in data and have been wrangled.

```{r}
Q1.1 = Q1 %>% 
  clean_names() %>% 
  select(sample_id, sample_date, k, no3) %>% 
  mutate(sample_date = mdy(sample_date)) %>% 
  group_by(sample_id, sample_date) %>% 
  summarize(k_daily_mean = mean(k), 
            no3_daily_mean = mean(no3))

Q2.1 = Q2 %>% 
  clean_names() %>% 
  select(sample_id, sample_date, k, no3) %>% 
  mutate(sample_date = mdy_hm(sample_date)) %>% 
  group_by(sample_id, sample_date) %>% 
  summarize(k_daily_mean = mean(k), 
            no3_daily_mean = mean(no3))

Q3.1 = Q3 %>% 
  clean_names() %>% 
  select(sample_id, sample_date, k, no3) %>% 
  mutate(sample_date = mdy(sample_date)) %>% 
  group_by(sample_id, sample_date) %>% 
  summarize(k_daily_mean = mean(k), 
            no3_daily_mean = mean(no3))

PRM.1 = PRM %>% 
  clean_names() %>% 
  select(sample_id, sample_date, k, no3) %>% 
  mutate(sample_date = mdy(sample_date)) %>% 
  mutate(sample_id = str_replace(string = sample_id, pattern = "MPR", replacement = "PRM")) %>%
  group_by(sample_id, sample_date) %>% 
  summarize(k_daily_mean = mean(k), 
            no3_daily_mean = mean(no3))
```

# Now that all four dataframes look the same, we need to combine them to one data frame for easy plotting.
```{r}
combined_data = rbind(Q1.1, Q2.1, Q3.1, PRM.1)
```

```{r}
data_ends = combined_data %>% filter(sample_date == "2012-12-26")

q = ggplot(combined_data, 
           aes(x = sample_date,
               y = k_daily_mean,
               color = sample_id)) +
  geom_line(aes(linetype = sample_id),
            show.legend = FALSE) +
        labs(x = "Year",
             y = "K concentration (mg/l)") +
  geom_text_repel(data = data_ends,
                  aes(color = sample_id,
                      label = sample_id),
                  show.legend = FALSE) + 
  facet_wrap(~ sample_id)

q

k = ggplot(combined_data,
           aes(x = sample_date,
               y = k_daily_mean,
               color = sample_id)) +
  geom_line(aes(linetype = sample_id),
            size = 0.4, show.legend = FALSE) +
        labs(x = "Year",
             y = "K concentration (mg/l)") + 
  theme(legend.title = element_blank())

p

no3 = ggplot(combined_data,
           aes(x = sample_date,
               y = no3_daily_mean,
               color = sample_id)) +
  geom_line(aes(linetype = sample_id),
            size = 0.4) +
        labs(x = "Year",
             y = "NO3 concentration (Î¼g/l)") + 
  theme(legend.title = element_blank())

d

k/no3

```


